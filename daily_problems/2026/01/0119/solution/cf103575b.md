**提示 1：** 只有奇数边是重要的。先用上必要的，如果不对再调整。

其实等价于我们选择偶数条权重是奇数的边。

有些奇数边的数量是不得不用的。我们先把所有偶数边连起来，那么为了接下来将这些连通块连起来，我们需要连通块数量减一条奇数边，我们把这些边连上。

接下来，如果此时奇数边刚好选了偶数条，则接下来连上偶数边使得整个图连通即可。

否则我们需要新增一条奇数边——能否做到呢？我们只需遍历还没有用到的奇数边看是否不和已有的奇数边成环就行。如果能做到，直接用它，再加上一系列偶数边即可。

时间复杂度为 $\mathcal{O}(n+m)$ ，如果认为并查集的复杂度是 $\mathcal{O}(1)$ 的。

### 具体代码如下——

Python 做法如下——

```Python []
def main(): 
    n, m = MII()
    us = []
    vs = []
    ws = []
    
    for _ in range(m):
        u, v, w = MII()
        u -= 1
        v -= 1
        us.append(u)
        vs.append(v)
        ws.append(w)
    
    uf1 = UnionFind(n)
    uf2 = UnionFind(n)
    
    for i in range(m):
        if ws[i] % 2 == 0:
            uf1.merge(us[i], vs[i])
    
    used = [0] * m
    even = 1
    
    for i in range(m):
        if ws[i] % 2 and uf1.merge(us[i], vs[i]):
            uf2.merge(us[i], vs[i])
            used[i] = 1
            even ^= 1
    
    if not even:
        for i in range(m):
            if ws[i] % 2 and not used[i] and uf2.merge(us[i], vs[i]):
                used[i] = 1
                even ^= 1
                break
    
    if not even: print('NO')
    else:
        for i in range(m):
            if ws[i] % 2 == 0 and uf2.merge(us[i], vs[i]):
                used[i] = 1
        
        print('YES')
        print(' '.join(str(i + 1) for i in range(m) if used[i]))
```

C++ 做法如下——

```cpp []
int main() {
	ios_base::sync_with_stdio(false);
	cin.tie(0);
	cout.tie(0);

	int n, m;
	cin >> n >> m;

	vector<array<int, 3>> edges(m);
	for (auto &[u, v, w]: edges) {
		cin >> u >> v >> w;
		u --, v --;
	}

	atcoder::dsu uf1(n), uf2(n);

	for (int i = 0; i < m; i ++) {
		auto [u, v, w] = edges[i];
		if (w % 2 == 0) uf1.merge(u, v);
	}

	vector<int> ans(m, 0);
	int even = 1;

	for (int i = 0; i < m; i ++) {
		auto [u, v, w] = edges[i];
		if (w % 2 && uf1.merge(u, v)) {
			uf2.merge(u, v);
			ans[i] = 1;
			even ^= 1;
		}
	}

	if (!even) {
		for (int i = 0; i < m; i ++) {
			auto [u, v, w] = edges[i];
			if (w % 2 && !ans[i] && uf2.merge(u, v)) {
				ans[i] = 1;
				even ^= 1;
				break;
			}
		}
	}

	if (!even) cout << "NO";
	else {
		for (int i = 0; i < m; i ++) {
			auto [u, v, w] = edges[i];
			if (w % 2 == 0 && uf2.merge(u, v))
				ans[i] = 1;
		}

		cout << "YES\n";
		for (int i = 0; i < m; i ++)
			if (ans[i]) cout << i + 1 << ' ';
	}

	return 0;
}
```
