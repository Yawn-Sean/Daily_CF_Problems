**提示 1：** 数组一般是递增的。如果某个位置非递增呢？

**提示 2：** 剩余的情况？

这个数组几乎每个位置都是递增的，但如果有个位置非递增，那一定跨行了。

而某两个数跨行了的话，第二个数就一定是行号了，此时第一个数在前一行，我们就能很快算出第一个数是第几列，也就找到答案了。

否则数组单调递增，此时直接考虑最后一个元素在第几行第几列即可。此时整体是等差数列，我们只需计算公差就知道是第几行，进而用除法可以快速算出是在第几列。

出题人还是比较善良的，保证了 $n\geq 2$ ，不然你还得找下 $n$ 的因子。

时间复杂度为 $\mathcal{O}(nm)$ 。

### 具体代码如下——

Python 做法如下——

```Python []
def main(): 
    t = II()
    outs = []
    
    for _ in range(t):
        n, m = MII()
        
        lsts = []
        for _ in range(n):
            lsts.append(LII())
    
        if n % 2 == 0:
            vis = [0] * (n * m // 2 + 1)
            
            ans = []
            for x in lsts:
                if vis[x[0]]: continue
                vis[x[0]] = 1
                ans.extend(x)
            
            outs.append(' '.join(map(str, ans)))
        
        else:
            next_pos = [0] * (n * m // 2 + 1)
            idxs = [0] * (n * m // 2 + 1)
    
            for i, lst in enumerate(lsts):
                idxs[lst[0]] = i
                next_pos[lst[0]] = lst[m // 2]
            
            ans = []
            
            cur = lsts[0][0]
            for _ in range(n):
                ans.extend(lsts[idxs[cur]][:m // 2])
                cur = next_pos[cur]
            
            outs.append(' '.join(map(str, ans)))
    
    print('\n'.join(map(str, outs)))
```

C++ 做法如下——

```cpp []
int main() {
	ios_base::sync_with_stdio(false);
	cin.tie(0);
	cout.tie(0);

	int t;
	cin >> t;

	while (t --) {
		int n, m;
		cin >> n >> m;

		vector<vector<int>> lsts(n, vector<int>(m));
		for (auto &x: lsts) for (auto &y: x) cin >> y;

		if (n % 2 == 0) {
			vector<int> vis(n * m / 2 + 1, 0);
			for (auto &x: lsts) {
				if (vis[x[0]]) continue;
				for (auto &v: x) cout << v << ' ';
				vis[x[0]] = 1;
			}
		}
		else {
			vector<int> next_pos(n * m / 2 + 1, 0);
			vector<int> idxs(n * m / 2 + 1, 0);

			for (int i = 0; i < n; i ++) {
				next_pos[lsts[i][0]] = lsts[i][m / 2];
				idxs[lsts[i][0]] = i;
			}

			int cur = lsts[0][0];
			for (int j = 0; j < n; j ++) {
				for (int k = 0; k < m / 2; k ++) {
					cout << lsts[idxs[cur]][k] << ' ';
				}
				cur = next_pos[cur];
			}
		}
		cout << '\n';
	}

	return 0;
}
```
