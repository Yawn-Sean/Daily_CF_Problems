
**提示一：** 绝对值函数具体形态如何？如何讨论？

**提示二：** 一系列绝对值函数的最小值如何刻画？

下面的题解就以上两个提示展开。

绝对值函数的取值受到其自变量正负性影响，可以理解为左右两段，整体呈现出 “V” 字的形态。而对于不同的自变量，只有两段中的一段决定了其取值。

因此我们把绝对值函数拆成两部分看。

我们具体地来看题目给出的绝对值函数，形如 $|x-a|+b$，那么其取值应当考虑为：

- $x\leq a: b+a-x$.

- $x\geq a: b-a+x$.

而一系列的绝对值函数可以理解为一系列的左边段，与一系列的右边段。**而每一点的最小值等于在这点发挥作用的 $\min(左边段的最小值, 右边段的最小值)$** 。

我们分别考虑左边段的最小值与右边段的最小值。

容易发现的是，左边段一旦在 $x$ 处发挥作用，那么其在 $x$ 左侧（及比 $x$ 更小的数的位置）都能发挥作用。而刻画一个左边段只需要维护 $a+b$（前面分类讨论中提到），因此只需要给出后缀的最小左边段标记。

右边段也是类似的，右边段一旦在 $x$ 处发挥作用，那么其在 $x$ 右侧（及比 $x$ 更大的数的位置）都能发挥作用。而刻画一个左边段只需要维护 $b-a$（前面分类讨论中提到），因此只需要给出前缀的最小右边段标记。

这样两侧维护完成，最终汇总即可。

时间复杂度为 $\mathcal{O}(n+k)$，只涉及求值、前后缀计算。

#### 具体代码如下（只包含中间处理部分）——

```Python []
def main():
    n, k = MII()
    pos = LGMI()
    temp = LII()
    
    # f1 用来维护右边段，f2 用来维护左边段
    f1 = [inf] * n
    f2 = [inf] * n
    
    for i in range(k):
        p = pos[i]
        t = temp[i]
        f1[p] = min(f1[p], t - p)
        f2[p] = min(f2[p], t + p)
    
    # 右边段算前缀
    for i in range(1, n):
        f1[i] = min(f1[i], f1[i-1])
    
    # 左边段算后缀
    for i in range(n - 1, 0, -1):
        f2[i-1] = min(f2[i], f2[i-1])
    
    print(*(min(f1[i] + i, f2[i] - i) for i in range(n)))
    return

```
