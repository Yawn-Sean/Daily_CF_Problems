**提示：** 想想平行四边形的判定条件，并思考怎么用简单的数据关系刻画。

我们先回顾下初中数学平行四边形的知识，其判定定理基本如下——

- 两组对边相等。

- 两组对边平行。

- 一组对边相等且平行。

- 两条对角线互相平分。

我们接下来考虑用上面的什么条件来数数。

第一 / 二个条件只有四个点都完全确定了才能判断，或者通过确定前三个点找第四个点，无论如何至少是 $\mathcal{O}(n^3)$ 的复杂度，一定无法完成任务，我们排除。

第三个条件我们可以用向量刻画，相当于相对的边满足向量完全相等。

这样我们可以独立统计每两个点构成的向量，再查看有多少个向量是相等的，就可以计算得到有多少平行四边形。

注意，一个平行四边形对应四组相等向量，所以结果是相等的向量组数除以 $4$ .

第四个条件用起来也很方便，我们可以统计每一组线段的中点，看有多少组线段的中点是重合的。

而每一组中点重合的线段刚好对应于一个平行四边形，因此统计重合组数即可。

时间复杂度为 $\mathcal{O}(n^2)$ ，下面按照第四个判定方法进行代码书写。

#### 具体代码如下（只包含中间处理部分）——

```Python []
def main():
    n = II()
    xs = []
    ys = []
    for _ in range(n):
        x, y = MII()
        xs.append(x)
        ys.append(y)

    mask = 1 << 32
    rnd = random.getrandbits(20)
    cnt = Counter()
    ans = 0
    for i in range(n):
        x1, y1 = xs[i], ys[i]
        for j in range(i):
            x2, y2 = xs[j], ys[j]
            ans += cnt[((x1 + x2) * mask + y1 + y2) ^ rnd]
            cnt[((x1 + x2) * mask + y1 + y2) ^ rnd] += 1
    print(ans)
    return
```
