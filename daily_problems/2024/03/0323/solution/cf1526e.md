**提示 1：** 先尝试理解后缀数组的定义，其相当于给出了所有形如 $s[i\dots n]$ 的后缀字符串的排序关系。这也就给出了所有 $s[i]$ 必须满足的大小关系。其如何？

**提示 2：** 字符大小关系已经基本确定，但其是否能取等号仍然需要进一步判断。如果两个字符可以相等，后缀数组应当满足什么限制？

我们先假设后缀数组为 $[v_1,v_2,\dots,v_n]$ 。则有字符串的比较关系：

$$s[v_1\dots]\lt s[v_2\dots]\lt\dots\lt s[v_n\dots]$$

于是根据上述字典序关系，这些字符串的第一个字符应当也满足对应的大小关系（但可以取等号）。很容易得出字符之间应当满足如下大小关系：

$$s[v_1]\leq s[v_2]\leq\dots\leq s[v_n]$$

但是取等号的情况下，并不能保证前面的后缀字符串比较关系成立。

**要使得 $s[v_k]=s[v_{k+1}]$ 的情况下，仍然有 $s[v_k\dots]\lt s[v_{k+1}\dots]$ ，我们实际上需要 $s[v_k+1]\lt s[v_{k+1}+1\dots]$ 。** 而这一步比较的也是两个后缀字符串，恰好可以通过后缀数组中 $v_k+1, v_{k+1}+1$ 出现的位置得到。

因此，如果后缀数组中 $v_k+1$ 出现的位置小于 $v_{k+1}+1$ 出现的位置，则 $s[v_k]=s[v_{k+1}]$ 允许成立，否则不允许成立。

于是，上述不等式关系中，有些等号不可取，有些等号可取。假设可取的共有 $cnt$ 个。

接下来就是经典组合数学问题了。我们举例说明如何求解。

假设我们有关系 $1\leq x_1\lt x_2\leq x_3\lt x_4\leq x_5\lt 100$ ，要求对应数列的个数，我们可以先将中间的小于等于号处理成小于号，具体如下——

$$1\leq x_1\lt x_2\lt x_3+1\lt x_4+1\lt x_5+2\lt 102$$

于是，我们相当于从 $102$ 个数中取 $5$ 个数，相当于有 $C_{102}^5$ 种方案。

在上述过程中，有多少个可以取等的不等号关系，右侧边界就加上多少，因此，我们本题的答案为 $C_{k+cnt}^n$ .

对此，我们计算 $(k+cnt)!, n!, \frac{1}{(k+cnt-n)!}$ 的取模结果即可，最后一个可以通过 $((k+cnt-n)!)^{mod-2}$ 进行计算。

时间复杂度为 $\mathcal{O}(n)$ .

#### 具体代码如下（只包含中间处理部分）——

```Python []
def main():
    mod = 998244353
    fact = Factorial(4 * 10 ** 5, mod)

    n, k = MII()
    sa = LGMI()
    pos = [-1] * (n + 1)
    for i in range(n):
        pos[sa[i]] = i

    cnt = 0
    for i in range(1, n):
        x, y = sa[i-1], sa[i]
        if pos[x+1] < pos[y+1]:
            cnt += 1

    print(fact.combi(k + cnt, n))
```