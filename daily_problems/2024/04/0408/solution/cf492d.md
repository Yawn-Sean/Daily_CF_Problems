**提示 1：** 直接寻找最后一击是谁的并不容易，更容易找到最后一击是什么时候。

**提示 2：** 如果我们知道最后一击是什么时候发出的，我们也可以很容易找到最后一击的发出者。

**提示 3：** 我们不善于使用浮点数，如何将计算转换为整数计算？

正如提示 1 所说，我们并没有太好的办法直接判断最后一击的发出者，但是我们可以得到最后一击的时间。

怎么得到呢？我们注意到发出的总攻击次数和时间是正相关的，因此时间越长，发出攻击次数越多，因此可以考虑使用二分查找，找到第一个满足总攻击次数超过所需的时间。

由于此时刚好取到最小时间，因此此刻 **一定发生了攻击，即是最后一击的发生时间** 。

而如何判断此刻发生的攻击是谁发出的呢？我们只需要注意到每个人发起攻击的时间是循环的，即只需查看截止时间是否恰好是其攻击周期的倍数。

而直接处理会涉及到浮点数，我们可以将两个角色的攻击时间 **直接乘以 $xy$** ，那么任何一个攻击时间都是整数，这就能方便我们使用二分了。

注意，二分上界应至少为 $10^9\times 10^6/2=10^{15} / 2$ 数量级左右，即两人均以最慢攻击频率进行攻击时的总用时。

时间复杂度为 $\mathcal{O}(q\log M)$ .

#### 具体代码如下（只包含中间处理部分）——

```Python []
def main():
    n, x, y = MII()
    outs = []
    for _ in range(n):
        v = II()
        l, r = 1, 10 ** 15
        while l <= r:
            m = (l + r) // 2
            if m // x + m // y >= v:
                r = m - 1
            else:
                l = m + 1
        if l % x == 0:
            if l % y == 0:
                outs.append('Both')
            else:
                outs.append('Vova')
        else:
            outs.append('Vanya')

    print('\n'.join(outs))
```
