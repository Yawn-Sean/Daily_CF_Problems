**提示 1：** 我们从前往后填数，为了使得后面填的数受到的限制更小，我们应当填尽可能小的数。

**提示 2：** 怎么填出比前面一项大的最小的数？

首先，我们从前往后考虑问题，每一个数都得比之前的数要大。

于是，如果我们选择从前往后填数，那么我们应该填比前一个数大的最小的数。这样我们可以保证每一个位置填上的数是最小的，也给后填的数字留足了填数空间（受到的限制更少了）。

因此，我们要做的只有一件事：找到比前一个数大的满足条件的最小的数。

这件事需要细致的分类讨论：

- 如果位数已经更大了，那么数字已经更大了，所有问号上填上最小的数即可——最高位是问号的话填 $1$ ，否则直接填 $0$ 。

- 如果位数已经更小了，那么数字也已经更小了，因此无论怎么填都无法满足题意，返回 `'NO'` 即可。

- 如果位数相同：

    - 考虑第一个非问号的不同的位。

    - 如果这一位前一个数更小，那么当前数字前面部分可以照抄原数，后面部分可以全部填 $0$ .

    - 如果这一位前一个数更大，要使得这一位置前面的部分严格大于前一个数。

        - 此时，前面的位只有问号的位置是重要的，因此把问号的位置提取出来，找到比原来的数对应位置严格更大的即可，这件事只需要进行加一的操作。
    
        - 而这一位后面的位置都可以填 $0$ .

    - 如果每一个非问号的位都相同，则可以跟前一种情况一样，提取所有问号的位置进行加一操作解决。

    - 注意，如果加一后数字已经多了一位，此时无法满足要求，直接输出 `'NO'` .

举个例子，如果你遇到了前一个数是 $869954$ 而你的新数需要满足 $?6?8??$ ，此时第一个不同非问号的不同位，前一个数更大，因此你提取前面部分的所有问号位置，是 $89$ ，因此这两个位置应当填入 $89+1=90$ 。而第一个不同位后面的位置都应该填入 $0$ 因此，构造的新数是 $960800$ .

时间复杂度为 $\mathcal{O}(n\log M)$ ，即所有数字的总位数。

#### 具体代码如下（只包含中间处理部分）——

```Python []
def main():
    n = II()
    last = ''
    ans = []

    for _ in range(n):
        s = list(I())
        if len(s) < len(last):
            print('NO')
            exit()
        elif len(s) > len(last):
            for i in range(len(s)):
                if s[i] == '?':
                    s[i] = '1' if i == 0 else '0'
        else:
            for i in range(len(s)):
                if s[i] != '?':
                    if s[i] > last[i]:
                        for j in range(i):
                            if s[j] == '?':
                                s[j] = last[j]
                        for j in range(i + 1, len(s)):
                            if s[j] == '?':
                                s[j] = '0'
                        break
                    elif s[i] < last[i]:
                        for j in range(i + 1, len(s)):
                            if s[j] == '?':
                                s[j] = '0'
                        f = False
                        for j in range(i - 1, -1, -1):
                            if s[j] == '?':
                                if f: s[j] = last[j]
                                else:
                                    if last[j] == '9':
                                        s[j] = '0'
                                    else:
                                        s[j] = chr(ord(last[j]) + 1)
                                        f = True
                        if not f:
                            print('NO')
                            exit()
                        break
            else:
                f = False
                for j in range(len(s) - 1, -1, -1):
                    if s[j] == '?':
                        if f: s[j] = last[j]
                        else:
                            if last[j] == '9':
                                s[j] = '0'
                            else:
                                s[j] = chr(ord(last[j]) + 1)
                                f = True
                if not f:
                    print('NO')
                    exit()
        
        last = ''.join(s)
        ans.append(last)

    print('YES')
    print('\n'.join(ans))
```
