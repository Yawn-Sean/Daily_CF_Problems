**提示 1：** 如果我们知道环上的某一条边，我们怎么推出环上的下一条边？

**提示 2：** 从 $0$ 出发的两条边，一定至少有一条对应于答案。

首先，这题告诉了我们从某个点出发走一步 / 两步到达的新位置。

如果我们知道这个图的一条边 $u\to v$ ，那么我们假设 $u$ 走一步 / 两步可以到达的位置为 $v_1, v_2$ ，则 $v_1, v_2$ 中一定包含 $v$ ，同时另一个点是 $v$ 连出的一条边的终点。

于是， **如果我们找到了一条边，我们可以马上找到下一条边** ，又因为整个图是个环，因此 **可以用这种方式找到整个图的所有边** 。

因此我们只需确定整个图的一条边即可。事实上，由于从 $0$ 出发的边只有两条，我们只需枚举其一，看是否满足题意即可。

上述过程复杂度为 $\mathcal{O}(n)$ .

**另解：** 考虑 $u$ 走一步和两步到达的 $v_1, v_2$ ，则 $v_1, v_2$ 之间一定有一条边，因此我们可以用这些边构成无向图，找到要求的环的去方向结果。最后为了确定环的方向，用 $u$ 走一步能否到达 $v_1, v_2$ 中的一个即可。

#### 具体代码如下（只包含中间处理部分）——

```Python []
def main():
    n = II()
    v = [[], []]
    
    for _ in range(n):
        x, y = GMI()
        v[0].append(x)
        v[1].append(y)
    
    for i in range(2):
        ans = [0, v[i][0]]
        for _ in range(n):
            u = ans[-2]
            f = False
            next_u = -1
            for j in range(2):
                if v[j][u] == ans[-1]: f = True
                else: next_u = v[j][u]
            if not f: break
            else: ans.append(next_u)
        
        if len(ans) == n + 2 and check(ans):
            print(' '.join(str(x + 1) for x in ans[:n]))
            break
```