考虑 $x^2+y^2=n$，设 $\gcd(x,y)=g$

我们可以通过 $(x,y),(x,-y)$ 得到 $(2x,0)$；同理得到 $(2y,0)$

由简单数论，知可以得到 $(2g,0)$

设 $x'=x/g,y'=y/g$， $x',y'$ 不可能同时为偶数，分讨一下，我们可以得到

- $(g,0)$，如果 $x',y'$ 有一个是偶数
- $(g,g)$，如果都是奇数

上面就是最简形式了，接下来考虑合并两组不同的 $(x,y)$

令 $g=\gcd(g_1,g_2),\ g_1=k_1g,\ g_2=k_2g$

- $(g_1,0),(g_2,0)\rightarrow(g,0)$
- $(g_1,g_1),(g_2,g_2)\rightarrow(g,g)$
- $(g_1,0),(g_2,g_2)$
  - $(g,0)$，如果 $k_1$ 是奇数，此时转为合并 $(k_1g,0),(2k_2g,0)$
  - $(g,g)$，如果 $k_1$ 是偶数，此时转为合并 $(k_1g,k_1g),(k_2g,k_2g)$

合并完后，考虑怎么计算答案，首先把左下角坐标变成非负数，这就一直加 $(g,g)$ 即可

设矩形左下角为 $(sx,sy)$，右上角为 $(tx,ty)$，那么类似前缀和的形式，

$$
\texttt{ans}=f(tx,ty)-f(sx-1,ty)-f(tx,sy-1)-f(sx-1,sy-1)
$$

其中 $f(x,y)$ 表示 $(0,0)$ 到 $(x,y)$ 有多少点能被走到，不过为了满足边界限制，当 $\min(x,y)<0$ 时， $f$ 直接返回 $0$

然后来计算 $f$

- 最终为 $(g,0)$ 的形式， $f(x,y)=\left(\lfloor\dfrac{x}{g}\rfloor+1\right)\left(\lfloor\dfrac{y}{g}\rfloor+1\right)$
- 最终为 $(g,g)$ 的形式，可以令 $g'=2g$，然后在 $g'$ 下，算出 $f(x,y)+f(x-g,y-g)$ 即可

当然还有很多细节需要处理，不过总之，这个题应该出成，~~固定 n，多组询问不同的 x,y,w,h~~

这个做法，似乎没用到“2的奇数次幂”这个条件
