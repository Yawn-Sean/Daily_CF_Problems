**提示 1：** 在前缀相同的情况下，下一位最优的选择是跟 $a_i$ 一致。如何判断这种填法是否满足要求？

**提示 2：** 不满足要求时，当前位怎么填？后面的位怎么填？

我们要让我们的字典序不比 $a$ 小，那么在前缀一致时，我们应该让下一位跟 $a_i$ 尽可能相等。

但相等可能跟前面的数不互质，这件事怎么判断呢？

互质可以视为所有质因子都不重复。因此，我们直接考虑对每个数进行质因数分解。这样前缀中用到的质因子都可以得到标记，而新的数只需判断其质因子是否标记过即可。

如果当前位置合法，我们继续往后遍历。

如果当前位置不合法，则我们要找到最小的大于 $a_i$ 的与前面的数互质的数。此时只需对当前位置不断 $+1$ ，直到找到想要的数即可。这里的 $+1$ 操作不会发生很多次，因为会在 $\mathcal{O}(M)$ 次操作中到达一个超出 $10^5$ 范围的质数。

而这个位置往后，填入的是不小于 $2$ 的满足条件的最小数，容易发现就是尚未作为因子出现过的最小的质数，因此我们预处理一个质数表即可。

时间复杂度为 $\mathcal{O}(n\log M+M\log\log M)$ ，如果使用埃氏筛。